/**
 * pii-guard/patterns.ts
 * ─────────────────────────────────────────────────────────────────────────────
 * Полный реестр паттернов PII.
 *
 * АРХИТЕКТУРНЫЕ РЕШЕНИЯ:
 * 1. priority — порядок применения: меньше = раньше.
 *    Специфичные паттерны (карты, СНИЛС) идут ДО общих (просто цифры).
 *    Это предотвращает "съедание" специфичного значения общим паттерном.
 *
 * 2. tokenName — русское название в токене [ТОКЕН_XXXXXX].
 *    LLM читает имя токена и понимает семантику: не трогает [КАРТА_...],
 *    не форматирует [ТЕЛЕФОН_...], правильно строит предложение.
 *
 * 3. group — категория для статистики и логирования.
 *
 * 4. Все regex используют флаг 'g' (глобальный поиск).
 *    ВАЖНО: перед каждым применением сбрасываем regex.lastIndex = 0.
 * ─────────────────────────────────────────────────────────────────────────────
 */

export interface PiiPattern {
  tokenName: string;   // Имя токена (русское, понятное LLM)
  group: string;       // Категория
  priority: number;    // Порядок применения (меньше = первее)
  regex: RegExp;
  description: string;
}

// ─────────────────────────────────────────────────────────────────────────────
// ВСПОМОГАТЕЛЬНАЯ ФУНКЦИЯ: собрать regex из массива слов
// ─────────────────────────────────────────────────────────────────────────────
function wordListRegex(words: string[], flags = 'gi'): RegExp {
  const escaped = words.map(w => w.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'));
  return new RegExp(`\\b(${escaped.join('|')})\\b`, flags);
}

// ─────────────────────────────────────────────────────────────────────────────
// ПАТТЕРНЫ
// ─────────────────────────────────────────────────────────────────────────────
export const PII_PATTERNS: PiiPattern[] = [

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 1: ФИНАНСОВЫЕ ДАННЫЕ (priority 1-19)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'КАРТА',
    group: 'finance',
    priority: 1,
    description: 'Номер банковской карты: Visa/MC/МИР 16 цифр, Amex 15 цифр',
    // 4-4-4-4 (с любым разделителем) или 4-6-5 (Amex)
    regex: /\b(?:\d{4}[\s\-]){3}\d{4}\b|\b\d{4}[\s\-]\d{6}[\s\-]\d{5}\b/g,
  },
  {
    tokenName: 'CVV',
    group: 'finance',
    priority: 2,
    description: 'CVV/CVC/CVC2 код карты после ключевого слова',
    regex: /(?:cvv|cvc2?|код[:\s]+карты|security\s+code)[:\s]+(\d{3,4})/gi,
  },
  {
    tokenName: 'СРОК_КАРТЫ',
    group: 'finance',
    priority: 3,
    description: 'Срок действия карты MM/YY или MM/YYYY',
    regex: /\b(0[1-9]|1[0-2])\s*[\/\-]\s*(\d{2}|\d{4})\b/g,
  },
  {
    tokenName: 'СЧЁТ_РФ',
    group: 'finance',
    priority: 4,
    description: 'Банковский счёт РФ — 20 цифр',
    regex: /\b[34678]\d{19}\b/g,
  },
  {
    tokenName: 'IBAN',
    group: 'finance',
    priority: 5,
    description: 'Международный счёт IBAN',
    regex: /\b[A-Z]{2}\d{2}[A-Z0-9]{4}\d{7,19}\b/g,
  },
  {
    tokenName: 'SWIFT',
    group: 'finance',
    priority: 6,
    description: 'SWIFT/BIC код банка',
    regex: /\b[A-Z]{4}[A-Z]{2}[A-Z0-9]{2}(?:[A-Z0-9]{3})?\b/g,
  },
  {
    tokenName: 'БИТКОИН',
    group: 'finance',
    priority: 7,
    description: 'Bitcoin адрес (Legacy, SegWit, Bech32)',
    regex: /\b(?:bc1[a-zA-HJ-NP-Z0-9]{25,39}|[13][a-zA-HJ-NP-Z0-9]{25,34})\b/g,
  },
  {
    tokenName: 'ЭФИР_АДРЕС',
    group: 'finance',
    priority: 8,
    description: 'Ethereum / EVM адрес (0x + 40 hex)',
    regex: /\b0x[a-fA-F0-9]{40}\b/g,
  },
  {
    tokenName: 'КРИПТО_SEED',
    group: 'finance',
    priority: 9,
    description: 'Мнемоническая фраза (seed-phrase) — 12/24 слова',
    // 12 или 24 English слова подряд через пробел (BIP-39)
    regex: /\b(?:[a-z]{3,8}\s){11}[a-z]{3,8}\b|\b(?:[a-z]{3,8}\s){23}[a-z]{3,8}\b/g,
  },
  {
    tokenName: 'КРИПТО_КЛЮЧ',
    group: 'finance',
    priority: 10,
    description: 'Приватный ключ криптокошелька (hex 64 символа)',
    regex: /\b[a-fA-F0-9]{64}\b/g,
  },
  {
    tokenName: 'НОМЕР_СЧЁТА',
    group: 'finance',
    priority: 11,
    description: 'Упоминание счёта с контекстом',
    regex: /(?:счёт|счет|расчётный счёт|р\/с)[:\s#№]*[\d\s]{16,25}/gi,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 2: ДОКУМЕНТЫ РФ (priority 20-39)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'СНИЛС',
    group: 'docs_ru',
    priority: 20,
    description: 'СНИЛС — XXX-XXX-XXX XX',
    regex: /\b\d{3}[\-–]\d{3}[\-–]\d{3}\s\d{2}\b/g,
  },
  {
    tokenName: 'ПАСПОРТ_РФ',
    group: 'docs_ru',
    priority: 21,
    description: 'Паспорт РФ: серия 4 цифры + номер 6 цифр (с контекстом)',
    regex: /(?:паспорт[:\s]*(?:серия[:\s]*)?\d{4}[\s\-]*\d{6}|\b\d{2}\s?\d{2}\s?\d{6}\b)/gi,
  },
  {
    tokenName: 'ЗАГРАНПАСПОРТ',
    group: 'docs_ru',
    priority: 22,
    description: 'Загранпаспорт РФ: 2 буквы + 7 цифр',
    regex: /\b[A-Z]{2}\d{7}\b/g,
  },
  {
    tokenName: 'ИНН_ФИЗ',
    group: 'docs_ru',
    priority: 23,
    description: 'ИНН физлица — 12 цифр',
    regex: /\b\d{12}\b/g,
  },
  {
    tokenName: 'ИНН_ЮР',
    group: 'docs_ru',
    priority: 24,
    description: 'ИНН юрлица — 10 цифр с контекстом',
    regex: /(?:инн|ИНН)[:\s]*(\d{10})/gi,
  },
  {
    tokenName: 'КПП',
    group: 'docs_ru',
    priority: 25,
    description: 'КПП — 9 цифр с контекстом',
    regex: /(?:кпп|КПП)[:\s]*(\d{9})/gi,
  },
  {
    tokenName: 'ОГРН',
    group: 'docs_ru',
    priority: 26,
    description: 'ОГРН (13) / ОГРНИП (15)',
    regex: /(?:огрнип|огрн|ОГРНИП|ОГРН)[:\s]*(\d{13}|\d{15})/gi,
  },
  {
    tokenName: 'ПОЛИС_ОМС',
    group: 'docs_ru',
    priority: 27,
    description: 'Полис ОМС — 16 цифр с контекстом',
    regex: /(?:полис|омс|ОМС)[:\s]*(\d{16})/gi,
  },
  {
    tokenName: 'ВОДИТЕЛЬСКОЕ',
    group: 'docs_ru',
    priority: 28,
    description: 'Водительское удостоверение РФ',
    regex: /(?:вод(?:ительское)?\s*(?:уд(?:остоверение)?)?|ву)[:\s]*([А-ЯЁA-Z]{2}\d{2}\s?\d{6})/gi,
  },
  {
    tokenName: 'СТС',
    group: 'docs_ru',
    priority: 29,
    description: 'Свидетельство о регистрации ТС',
    regex: /\b\d{2}[А-ЯЁA-Z]{2}\d{6}\b/gi,
  },
  {
    tokenName: 'VIN',
    group: 'docs_ru',
    priority: 30,
    description: 'VIN номер автомобиля — 17 символов',
    regex: /\b[A-HJ-NPR-Z0-9]{17}\b/g,
  },
  {
    tokenName: 'ГОСЛИЦЕНЗИЯ',
    group: 'docs_ru',
    priority: 31,
    description: 'Государственный регистрационный знак ТС (госномер)',
    // А123БВ77 или А 123 БВ 777
    regex: /\b[АВЕКМНОРСТУХABEKMHOPCTYX]{1}\d{3}[АВЕКМНОРСТУХABEKMHOPCTYX]{2}\d{2,3}\b/gi,
  },
  {
    tokenName: 'МЕДКАРТА',
    group: 'docs_ru',
    priority: 32,
    description: 'Номер медицинской карты с контекстом',
    regex: /(?:мед\.?\s*карт[аы]|история\s+болезни|амбулаторн[а-я]+\s+карт[аы])[:\s#№]*\d+/gi,
  },
  {
    tokenName: 'МКБ_КОД',
    group: 'docs_ru',
    priority: 33,
    description: 'МКБ-10 код диагноза',
    regex: /\b[A-Z]\d{2}(?:\.\d{1,2})?\b/g,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 3: ДОКУМЕНТЫ УКРАИНА (priority 40-49)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'ПАСПОРТ_УА',
    group: 'docs_ua',
    priority: 40,
    description: 'Паспорт Украины старого образца: 2 кириллических + 6 цифр',
    regex: /\b[АБВГҐДЕЄЖЗИІЇЙКЛМНОПРСТУФХЦЧШЩЬЮЯ]{2}\d{6}\b/gi,
  },
  {
    tokenName: 'ID_КАРТА_УА',
    group: 'docs_ua',
    priority: 41,
    description: 'ID-карта Украины: 9 цифр',
    regex: /(?:id[-\s]?карт[аы]|посвідчення)[:\s]*(\d{9})/gi,
  },
  {
    tokenName: 'РНОКПП',
    group: 'docs_ua',
    priority: 42,
    description: 'РНОКПП / ИНН Украины — 10 цифр с контекстом',
    regex: /(?:рнокпп|ідентифікаційний\s+код|інн)[:\s]*(\d{10})/gi,
  },
  {
    tokenName: 'СНИЛС_УА',
    group: 'docs_ua',
    priority: 43,
    description: 'ЄДРПОУ (код организации Украины) — 8 цифр',
    regex: /(?:єдрпоу|едрпоу|код\s+єдрпоу)[:\s]*(\d{8})/gi,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 4: ДОКУМЕНТЫ КАЗАХСТАН (priority 50-55)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'ИИН_КЗ',
    group: 'docs_kz',
    priority: 50,
    description: 'ИИН Казахстана — 12 цифр с контекстом',
    regex: /(?:иин|жеке\s+сәйкестендіру)[:\s]*(\d{12})/gi,
  },
  {
    tokenName: 'БИН_КЗ',
    group: 'docs_kz',
    priority: 51,
    description: 'БИН организации Казахстана — 12 цифр с контекстом',
    regex: /(?:бин)[:\s]*(\d{12})/gi,
  },
  {
    tokenName: 'ПАСПОРТ_КЗ',
    group: 'docs_kz',
    priority: 52,
    description: 'Паспорт Казахстана: N + 8 цифр',
    regex: /\bN\d{8}\b/g,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 5: КОНТАКТНЫЕ ДАННЫЕ (priority 60-69)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'ТЕЛЕФОН',
    group: 'contacts',
    priority: 60,
    description: 'Телефоны: RU (+7/8), UA (+38), KZ (+7), международные',
    regex: /(?:\+7|8)[\s\-\(]?\d{3}[\s\-\)]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}|(?:\+38)[\s\-\(]?\d{3}[\s\-\)]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}|\+(?!7|38)\d{1,3}[\s\-\(]?\d{1,4}[\s\-\)]?[\d\s\-]{6,14}/g,
  },
  {
    tokenName: 'ПОЧТА',
    group: 'contacts',
    priority: 61,
    description: 'Email адреса',
    regex: /\b[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}\b/g,
  },
  {
    tokenName: 'МЕССЕНДЖЕР',
    group: 'contacts',
    priority: 62,
    description: 'Никнеймы Telegram, WhatsApp, Viber с @',
    regex: /@[a-zA-Z][a-zA-Z0-9_]{4,31}\b/g,
  },
  {
    tokenName: 'SKYPE',
    group: 'contacts',
    priority: 63,
    description: 'Skype логин с контекстом',
    regex: /(?:skype|скайп)[:\s]+([a-zA-Z][a-zA-Z0-9_\-\.]{5,31})/gi,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 6: АДРЕСА (priority 70-79)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'АДРЕС_ПОЛНЫЙ',
    group: 'address',
    priority: 70,
    description: 'Полный адрес: индекс + населённый пункт + улица + дом',
    regex: /\b\d{6}\s*,\s*[а-яА-ЯёЁ\s]+,\s*(?:ул\.|улица|пр\.|проспект|пер\.|переулок|бульвар|шоссе|набережная|площадь)\s+[а-яА-ЯёЁ\s\d]+,\s*(?:д\.?\s*\d+[а-яА-ЯёЁ]?)(?:,\s*(?:кв|оф|стр|корп)\.?\s*\d+)*/gi,
  },
  {
    tokenName: 'УЛИЦА',
    group: 'address',
    priority: 71,
    description: 'Улица/проспект/переулок с названием',
    regex: /(?:ул\.|улица|пр-т\.?|проспект|пер\.|переулок|бульвар|б-р\.?|шоссе|ш\.?|набережная|наб\.|площадь|пл\.)\s+[«"]?[А-ЯЁа-яёA-Za-z][А-ЯЁа-яё\s\-]{1,60}[»"]?(?:\s*,\s*(?:д\.?\s*)?\d+[а-яА-ЯёЁ]?)?/gi,
  },
  {
    tokenName: 'ПОЧТОВЫЙ_ИНДЕКС',
    group: 'address',
    priority: 72,
    description: 'Почтовый индекс РФ — 6 цифр',
    regex: /\b\d{6}\b/g,
  },
  {
    tokenName: 'КВАРТИРА',
    group: 'address',
    priority: 73,
    description: 'Номер квартиры/офиса с контекстом',
    regex: /(?:кв\.?|квартира|оф\.?|офис|ком\.?|комната)[:\s]*\d+[а-яА-ЯёЁ]?/gi,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 7: ФИО И ЛИЧНЫЕ ДАННЫЕ (priority 80-89)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'ФИО',
    group: 'personal',
    priority: 80,
    description: 'ФИО на русском: Фамилия Имя [Отчество]',
    // Минимум 2 слова с заглавной буквы, каждое 2-30 символов
    regex: /\b(?:[А-ЯЁ][а-яё]{1,29}\s){1,2}[А-ЯЁ][а-яё]{1,29}(?:ич|вна|вич|овна|евна|евич|ович)?\b/g,
  },
  {
    tokenName: 'ФИО_ЛАТИНИЦА',
    group: 'personal',
    priority: 81,
    description: 'Имена на латинице: First [Middle] Last',
    regex: /\b(?:[A-Z][a-z]{1,29}\s){1,2}[A-Z][a-z]{1,29}\b/g,
  },
  {
    tokenName: 'ДАТА_РОЖДЕНИЯ',
    group: 'personal',
    priority: 82,
    description: 'Дата рождения в форматах DD.MM.YYYY, DD/MM/YYYY, YYYY-MM-DD',
    regex: /\b(?:0?[1-9]|[12]\d|3[01])[\.\-\/](?:0?[1-9]|1[0-2])[\.\-\/](?:19|20)\d{2}\b|\b(?:19|20)\d{2}[\.\-\/](?:0?[1-9]|1[0-2])[\.\-\/](?:0?[1-9]|[12]\d|3[01])\b/g,
  },
  {
    tokenName: 'ВОЗРАСТ',
    group: 'personal',
    priority: 83,
    description: 'Возраст с контекстом ("мне 34 года", "возраст: 45")',
    regex: /(?:мне|возраст|age)[:\s]+(\d{1,3})\s*(?:лет|год[аов]?|years?)?/gi,
  },
  {
    tokenName: 'ПРОФЕССИЯ',
    group: 'personal',
    priority: 84,
    description: 'Место работы с контекстом',
    regex: /(?:работаю в|работаю на|место работы|employer|работодатель)[:\s]+[А-ЯЁа-яёA-Za-z0-9\s"«»\-\.]{3,80}/gi,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 8: СЕТЕВЫЕ ИДЕНТИФИКАТОРЫ (priority 90-99)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'IP_АДРЕС',
    group: 'network',
    priority: 90,
    description: 'IPv4 адрес',
    regex: /\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\b/g,
  },
  {
    tokenName: 'IP6_АДРЕС',
    group: 'network',
    priority: 91,
    description: 'IPv6 адрес',
    regex: /(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}/g,
  },
  {
    tokenName: 'MAC_АДРЕС',
    group: 'network',
    priority: 92,
    description: 'MAC адрес сетевого устройства',
    regex: /\b(?:[0-9a-fA-F]{2}[:\-]){5}[0-9a-fA-F]{2}\b/gi,
  },
  {
    tokenName: 'JWT',
    group: 'network',
    priority: 93,
    description: 'JWT токен',
    regex: /eyJ[A-Za-z0-9\-_]+\.eyJ[A-Za-z0-9\-_]+\.[A-Za-z0-9\-_]+/g,
  },
  {
    tokenName: 'API_КЛЮЧ',
    group: 'network',
    priority: 94,
    description: 'API ключи с префиксами (sk-, pk-, Bearer и т.д.)',
    regex: /\b(?:sk-|pk-|api[-_]?key[=:\s]+|bearer\s+|token[=:\s]+)[A-Za-z0-9\-_\.]{20,}/gi,
  },
  {
    tokenName: 'ПАРОЛЬ',
    group: 'network',
    priority: 95,
    description: 'Пароли после ключевых слов',
    regex: /(?:пароль|password|passwd|pwd)[=:\s]+\S{4,}/gi,
  },
  {
    tokenName: 'SSH_КЛЮЧ',
    group: 'network',
    priority: 96,
    description: 'SSH приватный ключ',
    regex: /-----BEGIN[A-Z\s]+PRIVATE KEY-----[\s\S]+?-----END[A-Z\s]+PRIVATE KEY-----/g,
  },
  {
    tokenName: 'КУКИ',
    group: 'network',
    priority: 97,
    description: 'Cookie / session значения с контекстом',
    regex: /(?:cookie|session|PHPSESSID|JSESSIONID)[=:\s]+[A-Za-z0-9\-_\.%]{10,}/gi,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 9: БИОМЕТРИЯ И ЗДОРОВЬЕ (priority 100-109)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'РОСТ_ВЕС',
    group: 'biometric',
    priority: 100,
    description: 'Рост и вес с контекстом',
    regex: /(?:рост|вес|высота|weight|height)[:\s]+\d{2,3}(?:\.\d)?\s*(?:см|кг|kg|cm|lb|lbs)?/gi,
  },
  {
    tokenName: 'ГРУППА_КРОВИ',
    group: 'biometric',
    priority: 101,
    description: 'Группа крови',
    regex: /\b(?:I{1,3}V?|IV)\s*(?:\((?:A|B|AB|O)\))?\s*(?:Rh)?[+\-]/g,
  },
  {
    tokenName: 'ДИАГНОЗ',
    group: 'biometric',
    priority: 102,
    description: 'Диагноз с контекстом',
    regex: /(?:диагноз|diagnosis|диагностировали|заболевание)[:\s]+[А-ЯЁа-яёA-Za-z\s\-]{3,80}/gi,
  },

  // ══════════════════════════════════════════════════════════════════════════
  // ГРУППА 10: ГЕОГРАФИЯ С КОНТЕКСТОМ (priority 110-119)
  // ══════════════════════════════════════════════════════════════════════════

  {
    tokenName: 'ГЕО_КОНТЕКСТ',
    group: 'geo',
    priority: 110,
    description: 'Географическая привязка: "живу в X", "из X", "родом из X"',
    regex: /(?:живу|нахожусь|прописан[аы]?|зарегистрирован[аы]?|родом из|переехал[аи]?\s+(?:в|из)|нахожусь\s+в|нахожусь\s+на|базируюсь\s+в|базируемся\s+в)\s+(?:в\s+|из\s+)?([А-ЯЁа-яёA-Za-z][А-ЯЁа-яёA-Za-z\s\-]{2,60})/gi,
  },

  // ── СТРАНЫ (priority 111) ────────────────────────────────────────────────
  {
    tokenName: 'СТРАНА',
    group: 'geo',
    priority: 111,
    description: 'Все страны мира на русском и английском',
    regex: wordListRegex([
      // СНГ
      'Россия','России','РФ','Российская',
      'Украина','Украины','Украине',
      'Беларусь','Белоруссия','Беларуси',
      'Казахстан','Казахстана','Казахстане',
      'Узбекистан','Азербайджан','Грузия','Армения',
      'Молдова','Молдовы','Молдавия',
      'Кыргызстан','Киргизия','Таджикистан','Туркменистан',
      'Латвия','Литва','Эстония',
      // Европа
      'Германия','Германии','Germany',
      'Франция','Франции','France',
      'Италия','Италии','Italy',
      'Испания','Испании','Spain',
      'Португалия','Portugal',
      'Нидерланды','Netherlands','Голландия',
      'Бельгия','Belgium',
      'Швейцария','Switzerland',
      'Австрия','Austria',
      'Польша','Poland',
      'Чехия','Czech',
      'Словакия','Slovakia',
      'Венгрия','Hungary',
      'Румыния','Romania',
      'Болгария','Bulgaria',
      'Сербия','Serbia',
      'Хорватия','Croatia',
      'Греция','Greece',
      'Кипр','Cyprus',
      'Швеция','Sweden',
      'Норвегия','Norway',
      'Дания','Denmark',
      'Финляндия','Finland',
      'Исландия','Iceland',
      'Ирландия','Ireland',
      'Великобритания','Англия','England','Britain',
      'Шотландия','Scotland',
      'Люксембург','Luxembourg',
      'Монако','Monaco','Андорра','Andorra',
      'Лихтенштейн','Liechtenstein',
      'Ватикан','Vatican','Мальта','Malta',
      'Косово','Kosovo',
      // Северная Америка
      'США','Америка','America','United States',
      'Канада','Canada','Мексика','Mexico',
      'Куба','Cuba','Ямайка','Jamaica',
      'Панама','Panama','Коста-Рика','Costa Rica',
      'Гватемала','Guatemala','Белиз','Belize',
      // Южная Америка
      'Бразилия','Brazil','Аргентина','Argentina',
      'Чили','Chile','Колумбия','Colombia',
      'Венесуэла','Venezuela','Перу','Peru',
      'Боливия','Bolivia','Эквадор','Ecuador',
      'Парагвай','Paraguay','Уругвай','Uruguay',
      // Азия
      'Китай','China','КНР',
      'Япония','Japan','Корея','Korea',
      'Индия','India','Пакистан','Pakistan',
      'Бангладеш','Bangladesh',
      'Таиланд','Thailand','Вьетнам','Vietnam',
      'Малайзия','Malaysia','Сингапур','Singapore',
      'Индонезия','Indonesia','Филиппины','Philippines',
      'Монголия','Mongolia',
      'Афганистан','Afghanistan',
      'Иран','Iran','Ирак','Iraq',
      'Сирия','Syria','Ливан','Lebanon',
      'Израиль','Israel','Иордания','Jordan',
      'Саудовская Аравия','Saudi Arabia',
      'ОАЭ','UAE','Эмираты',
      'Катар','Qatar','Кувейт','Kuwait',
      'Турция','Turkey','Тайвань','Taiwan',
      'Гонконг','Hong Kong',
      // Африка
      'Египет','Egypt','Марокко','Morocco',
      'Тунис','Tunisia','Алжир','Algeria',
      'Ливия','Libya','Нигерия','Nigeria',
      'Кения','Kenya','Эфиопия','Ethiopia',
      'ЮАР','South Africa',
      // Океания
      'Австралия','Australia',
      'Новая Зеландия','New Zealand',
      'Фиджи','Fiji',
    ]),
  },

  // ── РЕГИОНЫ РФ (priority 112) ────────────────────────────────────────────
  {
    tokenName: 'РЕГИОН_РФ',
    group: 'geo',
    priority: 112,
    description: 'Все субъекты РФ: области, края, республики, округа',
    regex: wordListRegex([
      // Центральный ФО
      'Московская','Подмосковье','Тверская','Тверь',
      'Ярославская','Ярославль','Костромская','Кострома',
      'Ивановская','Иваново','Владимирская','Владимир',
      'Рязанская','Рязань','Тульская','Тула',
      'Орловская','Орёл','Калужская','Калуга',
      'Смоленская','Смоленск','Брянская','Брянск',
      'Курская','Курск','Белгородская','Белгород',
      'Воронежская','Воронеж','Липецкая','Липецк',
      'Тамбовская','Тамбов',
      // Северо-Западный ФО
      'Ленинградская','Карелия','Коми',
      'Архангельская','Архангельск',
      'Вологодская','Вологда',
      'Новгородская','Псковская','Псков',
      'Мурманская','Мурманск',
      'Калининградская','Ненецкий',
      // Южный ФО
      'Краснодарский','Краснодар','Кубань',
      'Ростовская','Волгоградская','Волгоград',
      'Астраханская','Астрахань','Калмыкия','Адыгея',
      'Крым','Севастополь',
      // Северо-Кавказский ФО
      'Ставропольский','Ставрополь',
      'Дагестан','Чечня','Чеченская','Ингушетия',
      'Северная Осетия','Алания',
      'Кабардино-Балкария','Карачаево-Черкесия',
      // Приволжский ФО
      'Нижегородская','Татарстан','Казань',
      'Башкортостан','Уфа','Самарская','Самара',
      'Саратовская','Саратов','Пензенская','Пенза',
      'Ульяновская','Ульяновск','Оренбургская','Оренбург',
      'Пермский','Пермь','Кировская','Киров',
      'Мордовия','Саранск','Чувашия','Чебоксары',
      'Марий Эл','Удмуртия','Ижевск',
      // Уральский ФО
      'Свердловская','Екатеринбург',
      'Челябинская','Челябинск',
      'Тюменская','Тюмень','Курганская','Курган',
      'ХМАО','Сургут','ЯНАО',
      // Сибирский ФО
      'Новосибирская','Омская','Томская','Томск',
      'Кемеровская','Кемерово','Кузбасс',
      'Алтайский','Барнаул','Алтай',
      'Красноярский','Красноярск',
      'Иркутская','Иркутск',
      'Бурятия','Улан-Удэ','Забайкальский','Чита',
      'Тыва','Кызыл','Хакасия','Абакан',
      // Дальневосточный ФО
      'Якутия','Якутск','Саха',
      'Приморский','Владивосток',
      'Хабаровский','Хабаровск',
      'Амурская','Благовещенск',
      'Сахалинская','Камчатский','Магаданская','Магадан',
      'Еврейская','Чукотский',
    ]),
  },

  // ── ГОРОДА РФ (priority 113) ─────────────────────────────────────────────
  {
    tokenName: 'ГОРОД_РФ',
    group: 'geo',
    priority: 113,
    description: 'Города России (100+ крупнейших)',
    regex: wordListRegex([
      'Москва','Московском','Московского',
      'Санкт-Петербург','Петербург','Питер',
      'Новосибирск','Екатеринбург','Нижний Новгород',
      'Челябинск','Омск','Ростов-на-Дону',
      'Уфа','Красноярск','Пермь','Воронеж',
      'Волгоград','Краснодар','Саратов','Тюмень',
      'Тольятти','Ижевск','Барнаул','Ульяновск',
      'Иркутск','Хабаровск','Ярославль','Владивосток',
      'Махачкала','Томск','Оренбург','Кемерово',
      'Новокузнецк','Рязань','Астрахань',
      'Набережные Челны','Пенза','Липецк','Киров',
      'Чебоксары','Тула','Курск','Магнитогорск',
      'Брянск','Иваново','Сочи','Улан-Удэ','Тверь',
      'Нижневартовск','Ставрополь','Белгород','Сургут',
      'Владимир','Мытищи','Химки','Балашиха',
      'Подольск','Люберцы','Королёв','Красногорск',
      'Одинцово','Дзержинск','Орёл','Смоленск',
      'Калининград','Чита','Архангельск','Якутск',
      'Мурманск','Симферополь','Грозный','Нальчик',
      'Майкоп','Элиста','Биробиджан',
      'Южно-Сахалинск','Петропавловск-Камчатский',
    ]),
  },

  // ── ГОРОДА УКРАИНЫ (priority 114) ───────────────────────────────────────
  {
    tokenName: 'ГОРОД_УА',
    group: 'geo',
    priority: 114,
    description: 'Города Украины',
    regex: wordListRegex([
      'Киев','Киеве','Киева','Kyiv',
      'Харьков','Харькове','Kharkiv',
      'Одесса','Одессе','Odesa',
      'Днепр','Днепре','Dnipro',
      'Запорожье','Zaporizhzhia',
      'Львов','Львове','Lviv',
      'Кривой Рог','Николаев','Mykolaiv',
      'Мариуполь','Mariupol','Луганск',
      'Херсон','Kherson','Чернигов','Chernihiv',
      'Полтава','Черкассы','Сумы','Ровно',
      'Житомир','Ужгород','Тернополь',
      'Хмельницкий','Черновцы','Chernivtsi',
      'Винница','Vinnytsia',
      'Ивано-Франковск','Кременчуг',
    ]),
  },

  // ── ГОРОДА КАЗАХСТАНА (priority 115) ────────────────────────────────────
  {
    tokenName: 'ГОРОД_КЗ',
    group: 'geo',
    priority: 115,
    description: 'Города Казахстана',
    regex: wordListRegex([
      'Алматы','Алма-Ата','Almaty',
      'Астана','Нур-Султан','Astana',
      'Шымкент','Shimkent','Актобе','Aktobe',
      'Қарағанды','Караганда','Karaganda',
      'Тараз','Taraz','Усть-Каменогорск',
      'Павлодар','Семей','Атырау','Актау',
      'Костанай','Петропавловск','Кызылорда',
      'Уральск','Темиртау','Жезказган',
    ]),
  },

  // ── МИРОВЫЕ ГОРОДА (priority 116) ───────────────────────────────────────
  {
    tokenName: 'ГОРОД_МИР',
    group: 'geo',
    priority: 116,
    description: 'Крупнейшие мировые города (200+)',
    regex: wordListRegex([
      // Европа
      'Лондон','London','Берлин','Berlin',
      'Париж','Paris','Мадрид','Madrid',
      'Рим','Rome','Барселона','Barcelona',
      'Вена','Vienna','Варшава','Warsaw',
      'Будапешт','Budapest','Прага','Prague',
      'Амстердам','Amsterdam','Брюссель','Brussels',
      'Стокгольм','Stockholm','Осло','Oslo',
      'Копенгаген','Copenhagen','Хельсинки','Helsinki',
      'Дублин','Dublin','Лиссабон','Lisbon',
      'Афины','Athens','Бухарест','Bucharest',
      'София','Белград','Belgrade','Загреб','Zagreb',
      'Вильнюс','Vilnius','Рига','Riga',
      'Таллин','Tallinn','Минск','Minsk',
      'Тбилиси','Tbilisi','Ереван','Yerevan',
      'Баку','Baku','Кишинёв','Chisinau',
      'Бишкек','Bishkek','Ташкент','Tashkent',
      'Душанбе','Dushanbe','Ашхабад','Ashgabat',
      'Стамбул','Istanbul','Анкара','Ankara',
      // Америка
      'Нью-Йорк','New York','NYC',
      'Лос-Анджелес','Los Angeles',
      'Чикаго','Chicago','Хьюстон','Houston',
      'Сан-Франциско','San Francisco',
      'Вашингтон','Washington',
      'Бостон','Boston','Майами','Miami',
      'Атланта','Atlanta','Сиэтл','Seattle',
      'Денвер','Denver','Лас-Вегас','Las Vegas',
      'Торонто','Toronto','Монреаль','Montreal',
      'Ванкувер','Vancouver','Мехико','Mexico City',
      'Богота','Bogota','Буэнос-Айрес','Buenos Aires',
      'Лима','Lima','Сантьяго','Santiago',
      'Рио-де-Жанейро','Rio de Janeiro',
      'Сан-Паулу','Sao Paulo','Бразилиа','Brasilia',
      // Азия
      'Токио','Tokyo','Пекин','Beijing',
      'Шанхай','Shanghai','Гонконг','Hong Kong',
      'Сеул','Seoul','Бангкок','Bangkok',
      'Куала-Лумпур','Kuala Lumpur',
      'Джакарта','Jakarta','Манила','Manila',
      'Мумбай','Mumbai','Дели','Delhi',
      'Бангалор','Bangalore','Карачи','Karachi',
      'Дакка','Dhaka','Тегеран','Tehran',
      'Дубай','Dubai','Абу-Даби','Abu Dhabi',
      'Эр-Рияд','Riyadh','Тель-Авив','Tel Aviv',
      'Иерусалим','Jerusalem','Амман','Amman',
      'Ханой','Hanoi','Хошимин','Ho Chi Minh',
      'Улан-Батор','Ulaanbaatar',
      'Кабул','Kabul','Багдад','Baghdad',
      'Дамаск','Damascus','Бейрут','Beirut',
      'Коломбо','Colombo','Катманду','Kathmandu',
      'Тайбэй','Taipei',
      // Африка
      'Каир','Cairo','Лагос','Lagos',
      'Найроби','Nairobi','Йоханнесбург','Johannesburg',
      'Кейптаун','Cape Town','Касабланка','Casablanca',
      'Аккра','Accra','Луанда','Luanda',
      'Аддис-Абеба','Addis Ababa','Дакар','Dakar',
      // Океания
      'Сидней','Sydney','Мельбурн','Melbourne',
      'Брисбен','Brisbane','Перт','Perth',
      'Аделаида','Adelaide','Канберра','Canberra',
      'Окленд','Auckland','Веллингтон','Wellington',
    ]),
  },

  // ── РАЙОНЫ И МИКРОРАЙОНЫ (priority 117) ──────────────────────────────────
  {
    tokenName: 'ГЕО_ОБЪЕКТ',
    group: 'geo',
    priority: 117,
    description: 'Улицы, микрорайоны, посёлки, сёла, деревни',
    regex: /(?:мкр\.?|микрорайон|квартал|кв-л|район|пос\.?|посёлок|деревня|дер\.?|село|с\.?|станица|ст-ца|аул|хутор|ж\/м)\s+[«"]?[А-ЯЁа-яёA-Za-z0-9][А-ЯЁа-яёA-Za-z0-9\s\-\.]{1,60}[»"]?/gi,
  },

];

// Экспортируем отсортированный массив (по приоритету)
export const SORTED_PATTERNS: PiiPattern[] =
  [...PII_PATTERNS].sort((a, b) => a.priority - b.priority);
